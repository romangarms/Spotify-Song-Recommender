{% extends "base.html" %}

{% block title %}
<title>System Account Setup Complete</title>
<style>
    #outer {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 90vh;
        padding: 20px;
        text-align: center;
    }

    .admin-container {
        max-width: 800px;
        width: 100%;
        background: #181818;
        padding: 40px;
        border-radius: 12px;
    }

    .admin-title {
        font-size: 2rem;
        font-weight: 900;
        color: #1DB954;
        margin-bottom: 1rem;
    }

    .admin-subtitle {
        font-size: 1rem;
        color: #b3b3b3;
        margin-bottom: 2rem;
    }

    .token-box {
        background: #282828;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        word-break: break-all;
        font-family: monospace;
        font-size: 0.9rem;
        color: #1DB954;
        border: 1px solid #333;
        text-align: left;
    }

    .instructions {
        text-align: left;
        color: #b3b3b3;
        line-height: 1.8;
    }

    .instructions h3 {
        color: white;
        margin-top: 2rem;
        margin-bottom: 1rem;
    }

    .instructions code {
        background: #282828;
        padding: 2px 8px;
        border-radius: 4px;
        font-family: monospace;
        color: #1DB954;
    }

    .instructions pre {
        background: #282828;
        padding: 15px;
        border-radius: 8px;
        overflow-x: auto;
        color: #1DB954;
    }

    .warning {
        background: #e74c3c;
        color: white;
        padding: 15px;
        border-radius: 8px;
        margin-top: 2rem;
    }

    .copy-btn {
        padding: 10px 20px;
        background: #1DB954;
        color: white;
        border: none;
        border-radius: 20px;
        cursor: pointer;
        font-weight: 600;
        margin-top: 10px;
    }

    .copy-btn:hover {
        background: #1ed760;
    }
</style>
{% endblock %}

{% block main %}
<div id="outer">
    <div class="admin-container">
        <h1 class="admin-title">System Account Setup Complete</h1>
        <p class="admin-subtitle">
            Your Spotify system account has been authorized successfully.
        </p>

        <div class="instructions">
            <h3>Your Refresh Token:</h3>
            <div class="token-box" id="token">{{ refresh_token }}</div>
            <button class="copy-btn" onclick="copyToken()">Copy Token</button>

            <h3>Next Steps:</h3>
            <p>Set this token as an environment variable on your server:</p>

            <p><strong>For Fly.io:</strong></p>
            <pre>fly secrets set SPOTIFY_SYSTEM_REFRESH_TOKEN={{ refresh_token }}</pre>

            <p><strong>For local development (.env file):</strong></p>
            <pre>SPOTIFY_SYSTEM_REFRESH_TOKEN={{ refresh_token }}</pre>

            <div class="warning">
                <strong>Important:</strong> Keep this token secure! Anyone with this token can create playlists on your system account.
                Do not share it or commit it to version control.
            </div>
        </div>
    </div>
</div>

<script>
function copyToken() {
    const token = document.getElementById('token').innerText;
    navigator.clipboard.writeText(token).then(() => {
        alert('Token copied to clipboard!');
    }).catch(err => {
        console.error('Failed to copy:', err);
    });
}
</script>
{% endblock %}
